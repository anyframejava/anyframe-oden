<project name="install 2 samsunglife" default="main" basedir=".">
	
	<property name="local.oden.home" location="../anyframe.oden.bundle"/>
	<property name="id" value="d25222" />
	<property name="pwd" value=""/>
	
	<macrodef name="send-file">
		<attribute name="svr"/>
		<attribute name="id" default="${id}"/>
		<attribute name="pwd" default="${pwd}"/>
		<attribute name="src.root"/>
		<attribute name="src.path"/>
		<attribute name="src.file"/>
		<sequential>
			<ftp server="@{svr}" userid="@{id}" password="@{pwd}" binary="yes">
				<fileset dir="@{src.root}/@{src.path}" includes="@{src.file}"/>
			</ftp>
			<telnet userid="@{id}" password="@{pwd}" server="@{svr}">
				<read>/home/@{id}</read>
				<write>chmod 755 .</write>
				<read>/home/@{id}</read>
				<write>sudo su - oden</write>
				<read>/Tools/oden</read>
				<write>mkdir -p @{src.path}</write>
				<read>/Tools/oden</read>
				<write>cp /home/@{id}/@{src.file} @{src.path}</write>
				<read>/Tools/oden</read>
				<write>exit</write>
				<read>/home/@{id}</read>
				<write>rm /home/@{id}/@{src.file}</write>
			</telnet>
		</sequential>
	</macrodef>
			
	<macrodef name="install-agent">
		<attribute name="svr"/>
		<attribute name="id" default="${id}"/>
		<attribute name="pwd" default="${pwd}"/>
		<attribute name="src.path" default="pack"/>
		<attribute name="src.file" default="oden-agent-1.0.0.tar.gz"/>
		<attribute name="desc" default=""/>
		<sequential>
			<send-file svr="@{svr}" src.root="${local.oden.home}" 
				src.path="bundle" src.file="remote-1.0.0.RC4.jar" />
			<!--
			<send-file svr="@{svr}" src.root="${basedir}" 
				src.path="@{src.path}" src.file="@{src.file}" />
			<telnet userid="@{id}" password="@{pwd}" server="@{svr}">
				<read>/home/@{id}</read>
				<write>sudo su - oden</write>
				<read>/Tools/oden</read>
				<write>gunzip &lt; @{src.path}/@{src.file} | tar xf -</write>
				<read>/Tools/oden</read>
				<write>chmod 755 shutdown.sh</write>
				<read>/Tools/oden</read>
				<write>chmod 755 startup.sh</write>
				<read>/Tools/oden</read>
				<write>rm @{src.path}/@{src.file}</write>
			</telnet>-->
		</sequential>
	</macrodef>
	
	<macrodef name="reset-agent">
		<attribute name="svr"/>
		<attribute name="id" default="${id}"/>
		<attribute name="pwd" default="${pwd}"/>
		<attribute name="desc" default=""/>
		<sequential>
			<telnet userid="@{id}" password="@{pwd}" server="@{svr}">
				<read>/home/@{id}</read>
				<write>sudo su - oden</write>
				<read>/Tools/oden</read>
				<write>./shutdown.sh</write>
				<read>/Tools/oden</read>
				<write>./startup.sh</write>
				<read>All rights reserved.</read>
			</telnet>
		</sequential>
	</macrodef>
	
	<target name="install.oden">
		<tstamp>
	    	<format property="TODAY" pattern="yyMMdd" locale="en,KOREA"/>
	  	</tstamp>
		<property name="svr" value="ad1.xt.develop.samsunglife.kr"/>
		
		<ftp server="${svr}" userid="${id}" password="${pwd}" binary="yes">
			<fileset file="pack/oden-1.0.0.tar.gz"/>
		</ftp>
		<telnet userid="${id}" password="${pwd}" server="${svr}">
			<read>/home/${id}</read>
			<write>chmod 755 .</write>
			<read>/home/${id}</read>
			<write>sudo su - oden</write>
			
			<read>/Tools/oden</read>
			<write>mkdir -p install/1.0.0.${TODAY}</write>
			<read>/Tools/oden</read>
			<write>mkdir snapshots</write>
			
			<read>/Tools/oden</read>
			<write>cp /home/${id}/oden-1.0.0.tar.gz install/1.0.0.${TODAY}</write>
			
			<read>/Tools/oden</read>
			<write>gunzip &lt; install/1.0.0.${TODAY}/oden-1.0.0.tar.gz | tar xf -</write>
			
			<read>/Tools/oden</read>
			<write>chmod 755 shutdown.sh</write>
			<read>/Tools/oden</read>
			<write>chmod 755 startup.sh</write>
			
			<read>/Tools/oden</read>
			<write>exit</write>
			
			<read>/home/${id}</read>
			<write>rm /home/${id}/oden-1.0.0.tar.gz</write>
			<read>/home/${id}</read>
			<write>ls /Tools/oden</write>
			<read>/home/${id}</read>
		</telnet>
		<reset-agent svr="ad1.xp.develop.samsunglife.kr"/>
	</target>
	
	
	<target name="send.xmlrpc">
		<property name="svr" value="ad1.xp.develop.samsunglife.kr"/>
		<send-file svr="${svr}" src.root="${basedir}" 
			src.path="rscs" src.file="xmlrpc.xml" />
	</target>
	
	<target name="send.oden.core">
		<property name="svr" value="ad1.xp.develop.samsunglife.kr"/>
		<send-file svr="${svr}" src.root="${local.oden.home}" 
			src.path="bundle" src.file="anyframe.oden.bundle.core-1.0.0.jar" />
	</target>
	
	<target name="send.oden.repo">
		<property name="svr" value="ad1.xt.develop.samsunglife.kr"/>
		<send-file svr="${svr}" src.root="${local.oden.home}" 
			src.path="bundle" src.file="anyframe.oden.bundle.repository-1.0.0.jar" />
	</target>
	
	<target name="send.oden.samsunglife">
		<property name="svr" value="ad1.xt.develop.samsunglife.kr"/>
		<send-file svr="${svr}" src.root="${local.oden.home}" 
			src.path="bundle" src.file="anyframe.oden.bundle.samsunglife-1.0.0.jar" />
	</target>
	
	<target name="install.agents">
		<!-- FLPP0W -->
		<install-agent svr="wb1.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb1.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb2.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb2.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb3.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb3.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb4.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb4.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb5.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb5.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb6.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb6.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb7.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb7.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb8.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb8.xp.portal.samsunglife.kr"/>
		<install-agent svr="wb9.xp.portal.samsunglife.kr"/>
		<reset-agent svr="wb9.xp.portal.samsunglife.kr"/>

		<!-- FLPP0A -->
		<install-agent svr="ap1.xp.portal.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.portal.samsunglife.kr"/>
		<install-agent svr="ap2.xp.portal.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.portal.samsunglife.kr"/>
		<install-agent svr="ap3.xp.portal.samsunglife.kr"/>
		<reset-agent svr="ap3.xp.portal.samsunglife.kr"/>
		<install-agent svr="ap4.xp.portal.samsunglife.kr"/>
		<reset-agent svr="ap4.xp.portal.samsunglife.kr"/>
		
		<!-- FLPC0A -->
		<!--<install-agent svr="ap1.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap1.xp.core.samsunglife.kr" desc="conn fail"/>
		<install-agent svr="ap2.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap2.xp.core.samsunglife.kr" desc="conn fail"/>
		<install-agent svr="ap3.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap3.xp.core.samsunglife.kr" desc="conn fail"/>
		<install-agent svr="ap4.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap4.xp.core.samsunglife.kr" desc="conn fail"/>
		<install-agent svr="ap5.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap5.xp.core.samsunglife.kr" desc="conn fail"/>
		<install-agent svr="ap6.xp.core.samsunglife.kr" desc="conn fail"/>
		<reset-agent svr="ap6.xp.core.samsunglife.kr" desc="conn fail"/>-->
		
		<!-- FLPCHA -->
		<install-agent svr="ap1.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.channel.samsunglife.kr"/>
		<install-agent svr="ap2.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.channel.samsunglife.kr"/>
		<install-agent svr="ap3.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap3.xp.channel.samsunglife.kr"/>
		<install-agent svr="ap4.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap4.xp.channel.samsunglife.kr"/>
		<install-agent svr="ap5.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap5.xp.channel.samsunglife.kr"/>
		<install-agent svr="ap6.xp.channel.samsunglife.kr"/>
		<reset-agent svr="ap6.xp.channel.samsunglife.kr"/>
		
		<!-- FLPCUA -->
		<install-agent svr="ap1.xp.customer.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.customer.samsunglife.kr"/>
		<install-agent svr="ap2.xp.customer.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.customer.samsunglife.kr"/>
		
		<!-- FLPCCA -->
		<install-agent svr="ap1.xp.callcenter.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.callcenter.samsunglife.kr"/>
		<install-agent svr="ap2.xp.callcenter.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.callcenter.samsunglife.kr"/>
		
		<!-- FLPPRA -->
		<install-agent svr="ap1.xp.product.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.product.samsunglife.kr"/>
		
		<!-- FLPC0BA -->
		<install-agent svr="ap1.xp.batch.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.batch.samsunglife.kr"/>
		
		<!-- FLPCRA -->
		<install-agent svr="ap1.xp.campaign.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.campaign.samsunglife.kr"/>
		
		<!-- FLPBPA -->
		<install-agent svr="ap1.xp.bpm.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.bpm.samsunglife.kr"/>
		<install-agent svr="ap2.xp.bpm.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.bpm.samsunglife.kr"/>
		
		<!-- FLPAMA -->
		<install-agent svr="ap1.xp.iam.samsunglife.kr"/>
		<reset-agent svr="ap1.xp.iam.samsunglife.kr"/>
		<install-agent svr="ap2.xp.iam.samsunglife.kr"/>
		<reset-agent svr="ap2.xp.iam.samsunglife.kr"/>
		
		<!-- FLPDSE -->
	</target>
	
	<target name="reset.svr">
		<reset-agent svr="ad1.xp.develop.samsunglife.kr"/>
	</target>
	
	<target name="main">
	</target>
</project>
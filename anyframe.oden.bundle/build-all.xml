<project name="_Oden Full" default="build.all" basedir=".">
	<property name="version" value="1.0.0.RC2"/>
	
	<target name="build.all">
		<ant antfile="../anyframe.oden.bundle/build.xml" inheritall="false" />
			
		<ant antfile="/Users/coelumscio/local/versions/common/bundle/trunk/dev/anyframe.common.bundle.gate/build.xml" inheritall="false" />

		<ant antfile="/Users/coelumscio/local/versions/common/bundle/trunk/dev/anyframe.common.bundle.log/build.xml" inheritall="false" />

		<ant antfile="../anyframe.oden.bundle.common/build.xml" inheritall="false" />
		
		<ant antfile="../anyframe.oden.bundle.prefs/build.xml" inheritall="false" />
				
		<ant antfile="../anyframe.oden.bundle.deploy/build.xml" inheritall="false" />

		<ant antfile="../anyframe.oden.bundle.repository/build.xml" inheritall="false" />

		<ant antfile="../anyframe.oden.bundle.core/build.xml" inheritall="false" />
	</target>
	
	<target name="pack.agent" depends="pack.all"
			description="package oden agent">
		<delete dir="${basedir}/pack" excludes="*.zip"/>
		<mkdir dir="${basedir}/pack/bin"/>
		<mkdir dir="${basedir}/pack/bundle"/>
		
		<copy todir="${basedir}/pack/bin">
			<fileset dir="dist" includes="oden-*.jar"/>
		</copy>
		<copy todir="${basedir}/pack/bundle">
			<fileset dir="${basedir}/bundle" 
				includes=
					"anyframe.oden.bundle.deploy-*.jar
					anyframe.oden.bundle.common-*.jar
					org.apache.felix.eventadmin-*.jar
					org.apache.felix.log-*.jar
					org.apache.felix.scr-*.jar
					remote-*.jar
					felix*.jar"/>
		</copy>
		<copy todir="${basedir}/pack">
			<fileset dir="${basedir}"
				includes="readme,oden-agent.cmd"/>
		</copy>
		
		<zip destfile="${basedir}/pack/oden-agent-${version}.zip"
			basedir="${basedir}/pack" excludes="*.zip,**/*.svn,conf"/>
	</target>
			
	<target name="pack.all" depends="build.all"
			description="package oden">
		<delete dir="${basedir}/pack" excludes="*.zip"/>		<!-- exclude zip to prevent to remove previous versions and agent packages.-->
		<mkdir dir="${basedir}/pack/bin"/>
		<mkdir dir="${basedir}/pack/bundle"/>
		<mkdir dir="${basedir}/pack/conf"/>
		
		<copy todir="${basedir}/pack/bin">
			<fileset dir="dist" includes="oden-*.jar"/>
		</copy>
		<copy todir="${basedir}/pack/bundle">
			<fileset dir="${basedir}/bundle" 
				includes="*.jar" excludes="oden-*.jar" />
		</copy>
		<copy todir="${basedir}/pack/conf">
			<fileset dir="${basedir}/conf"
				includes="*.ini,*.xml"/>
		</copy>
		<copy todir="${basedir}/pack">
			<fileset dir="../doc/pdf"
				includes="*.pdf"/>
			<fileset dir="${basedir}"
				includes="readme,oden.cmd"/>
		</copy>
		
		<zip destfile="${basedir}/pack/oden-${version}.zip"
			basedir="${basedir}/pack" excludes="*.zip,**/*.svn"/>
	</target>
</project>